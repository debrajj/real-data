{%- liquid
    assign show_dynamic_checkout = block.settings.show_dynamic_checkout
    assign atc_animation = block.settings.atc_animation
    assign atc_color = block.settings.atc_color
    assign atc_border_color = block.settings.atc_border_color
    assign atc_bg_color = block.settings.atc_bg_color
    assign atc_bg_color_gradient = block.settings.atc_bg_color_gradient
    assign atc_color_hover = block.settings.atc_color_hover
    assign atc_border_color_hover = block.settings.atc_border_color_hover
    assign atc_bg_color_hover = block.settings.atc_bg_color_hover
    assign atc_bg_color_gradient_hover = block.settings.atc_bg_color_gradient_hover
    assign bin_color = block.settings.bin_color
    assign bin_border_color = block.settings.bin_border_color
    assign bin_bg_color = block.settings.bin_bg_color
    assign bin_bg_color_gradient = block.settings.bin_bg_color_gradient
    assign bin_color_hover = block.settings.bin_color_hover
    assign bin_border_color_hover = block.settings.bin_border_color_hover
    assign bin_bg_color_hover = block.settings.bin_bg_color_hover
    assign bin_bg_color_hover_gradient = block.settings.bin_bg_color_hover_gradient
    assign gift_card_recipient_feature_active = false
      if block.settings.show_gift_card_recipient and product.gift_card?
        assign gift_card_recipient_feature_active = true
      endif
    assign sticky_add_to_cart_always_mb = section.settings.enable_sticky_add_to_cart_always_mobile
-%}

{%- assign product_form_installment_id = 'product-form-installment-' | append: product.id -%}
{%- form 'product', product, id: product_form_installment_id, class: 'installment caption-large' -%}
    <input type="hidden" name="id" value="{{ current_variant.id }}">
    {{ form | payment_terms }}
{%- endform -%}

{%- assign product_form_id = 'product-form-' | append: product.id -%}
<product-form class="productView-form product-form{% if sticky_add_to_cart_always_mb %} always-on-mobile{% endif %}">
    {%- form 'product', product, id: product_form_id, class: 'form', novalidate: 'novalidate', data-type: 'add-to-cart-form' -%}
        {%- if gift_card_recipient_feature_active -%}
          {%- render 'gift-card-recipient-form', product: product, form: form, section: section -%}
        {%- endif -%}
        <div class="productView-group">
            {%- if check_show_qty == 'show_qty_2' -%}
                {%- if product.quantity_price_breaks_configured? -%}
                    <price-per-item
                        id="Price-Per-Item-{{ section.id }}"
                        data-section-id="{{ section.id }}"
                        data-variant-id="{{ product.selected_or_first_available_variant.id }}"
                        >
                        {%- if product.selected_or_first_available_variant.quantity_price_breaks.size > 0 -%}
                          {%- assign variant_price_compare = product.selected_or_first_available_variant.compare_at_price -%}
                          <div class="price-per-item">
                            {%- if variant_price_compare -%}
                              <dl class="price-per-item--current">
                                <dt class="visually-hidden">
                                  {{ 'products.product.price.regular_price' | t }}
                                </dt>
                                <dd>
                                  <s class="variant-item__old-price">
                                    {{ variant_price_compare | money_with_currency }}
                                  </s>
                                </dd>
                              </dl>
                            {%- endif -%}
                            {%- if current_qty_for_volume_pricing < volume_pricing_array.last.minimum_quantity -%}
                              {%- assign variant_price = product.selected_or_first_available_variant.price
                                | money_with_currency
                              -%}
                              <span class="price-per-item--current">
                                {{- 'products.product.volume_pricing.price_at_each' | t: price: variant_price -}}
                              </span>
                            {%- else -%}
                              {%- for price_break in volume_pricing_array -%}
                                {%- if current_qty_for_volume_pricing >= price_break.minimum_quantity -%}
                                  {%- assign price_break_price = price_break.price | money_with_currency -%}
                                  <span class="price-per-item--current">
                                    {{-
                                      'products.product.volume_pricing.price_at_each'
                                      | t: price: price_break_price
                                    -}}
                                  </span>
                                  {%- break -%}
                                {%- endif -%}
                              {%- endfor -%}
                            {%- endif -%}
                          </div>
                        {%- else -%}
                          {%- assign variant_price = product.selected_or_first_available_variant.price
                            | money_with_currency
                          -%}
                          {%- assign variant_price_compare = product.selected_or_first_available_variant.compare_at_price -%}
                          <div class="price-per-item">
                            {%- if variant_price_compare -%}
                              <dl class="price-per-item--current">
                                <dt class="visually-hidden">
                                  {{ 'products.product.price.regular_price' | t }}
                                </dt>
                                <dd>
                                  <s class="variant-item__old-price">
                                    {{ variant_price_compare | money_with_currency }}
                                  </s>
                                </dd>
                                <dt class="visually-hidden">
                                  {{ 'products.product.price.sale_price' | t }}
                                </dt>
                                <dd>
                                  <span class="price-per-item--current">
                                    {{- 'products.product.volume_pricing.price_at_each' | t: price: variant_price -}}
                                  </span>
                                </dd>
                              </dl>
                            {%- else -%}
                              <span class="price-per-item--current">
                                {{- 'products.product.volume_pricing.price_at_each' | t: price: variant_price -}}
                              </span>
                            {%- endif -%}
                          </div>
                        {%- endif -%}
                    </price-per-item>
                    <div class="quantity__rules caption" id="Quantity-Rules-{{ section.id }}">
                        {%- if product.selected_or_first_available_variant.quantity_rule.increment > 1 -%}
                          <span class="divider">
                            {{-
                              'products.product.quantity.multiples_of'
                              | t: quantity: product.selected_or_first_available_variant.quantity_rule.increment
                            -}}
                          </span>
                        {%- endif -%}
                        {%- if product.selected_or_first_available_variant.quantity_rule.min > 1 -%}
                          <span class="divider">
                            {{-
                              'products.product.quantity.minimum_of'
                              | t: quantity: product.selected_or_first_available_variant.quantity_rule.min
                            -}}
                          </span>
                        {%- endif -%}
                        {%- if product.selected_or_first_available_variant.quantity_rule.max != null -%}
                          <span class="divider">
                            {{-
                              'products.product.quantity.maximum_of'
                              | t: quantity: product.selected_or_first_available_variant.quantity_rule.max
                            -}}
                          </span>
                        {%- endif -%}
                    </div>
                    <volume-pricing class="parent-display" id="Volume-{{ section.id }}">
                      {%- if product.selected_or_first_available_variant.quantity_price_breaks.size > 0 -%}
                        <span class="caption-large">{{ 'products.product.volume_pricing.title' | t }}</span>
                        <ul class="list-unstyled">
                          <li>
                            <span>{{ product.selected_or_first_available_variant.quantity_rule.min }}+</span>
                            {%- assign price = product.selected_or_first_available_variant.price
                              | money_with_currency
                            -%}
                            <span data-text="{{ 'products.product.volume_pricing.price_at_each' | t: price: variant_price }}">
                              {{- 'sections.quick_order_list.each' | t: money: price -}}
                            </span>
                          </li>
                          {%- for price_break in product.selected_or_first_available_variant.quantity_price_breaks -%}
                            {%- assign price_break_price = price_break.price | money_with_currency -%}
                            <li class="{%- if forloop.index >= 3 -%}show-more-item hidden{%- endif -%}">
                              <span>
                                {{- price_break.minimum_quantity -}}
                                <span aria-hidden="true">+</span></span
                              >
                              <span data-text="{{ 'products.product.volume_pricing.price_at_each' | t: price: price_break_price }}">
                                {{- 'sections.quick_order_list.each' | t: money: price_break_price -}}
                              </span>
                            </li>
                          {%- endfor -%}
                        </ul>
                        {%- if product.selected_or_first_available_variant.quantity_price_breaks.size >= 3 -%}
                            <show-more-button>
                                <button
                                  class="button-show-more link underlined-link"
                                  id="Show-More-{{ section.id }}"
                                  type="button"
                                >
                                  <span class="label-show-more label-text"
                                    ><span aria-hidden="true">+ </span>{{ 'general.button_load_more.default' | t }}
                                  </span>
                                </button>
                            </show-more-button>
                        {%- endif -%}
                      {%- endif -%}
                    </volume-pricing>
                {%- endif -%}
            {%- endif -%}
            <div class="pvGroup-row">
              {% if variant_type > 1 %}
                {%- if step_by_step_variant -%}
                  <div class="productView-prev clearfix{% if settings.banner_animation == 'effect_fade_up' %} scroll-trigger animate--slide-in{% endif %}">
                    <a role="link" aria-disabled="true" data-action="prev" class="btn-step-variant btn-prev__variant">
                      <span class="visually-hidden">{{ 'products.product.step_by_step.previous' | t }}</span>{% render 'icon-chevron-left' %}
                    </a>
                  </div>
                {%- endif -%}
              {% endif %}
                {%- if check_show_qty == 'show_qty_1' or check_show_qty == 'show_qty_2' -%}
                    {%- liquid
                        if check_show_qty == 'show_qty_1'
                            assign check_hidden = true
                        endif
                    -%}
                    {% render 'product-quantity', current_variant: current_variant, check_hidden: check_hidden, qty_style: qty_style, quantity_stt: 1, product: product %}
                {%- endif -%}
                <div class="productView-groupTop">
                    <input type="hidden" name="id" value="{{ current_variant.id }}">
                    
                    {%- comment -%} BUTTONS IN ONE LINE - 50% Add to Cart + 50% Buy Now {%- endcomment -%}
                    <div class="productView-buttons" style="--atc-color: {{ atc_color }};--atc-bg-color: {% if atc_bg_color_gradient != blank %}{{ atc_bg_color_gradient }}{% else %}{{ atc_bg_color }}{% endif %};--atc-border-color: {{ atc_border_color }};--atc-color-hover: {{ atc_color_hover }};--atc-bg-color-hover: {% if atc_bg_color_gradient_hover != blank %}{{ atc_bg_color_gradient_hover }}{% else %}{{ atc_bg_color_hover }}{% endif %};--atc-border-color-hover: {{ atc_border_color_hover }};--bin-color: {{ bin_color }};--bin-bg-color: {% if bin_bg_color_gradient != blank %}{{ bin_bg_color_gradient }}{% else %}{{ bin_bg_color }}{% endif %};--bin-border-color: {{ bin_border_color }};--bin-color-hover: {{ bin_color_hover }};--bin-bg-color-hover: {% if bin_bg_color_hover_gradient != blank %}{{ bin_bg_color_hover_gradient }}{% else %}{{ bin_bg_color_hover }}{% endif %};--bin-border-color-hover: {{ bin_border_color_hover }}">
                        
                        {%- comment -%} ADD TO CART BUTTON - 50% WIDTH {%- endcomment -%}
                        <div class="productView-action{% if settings.banner_animation == 'effect_fade_up' %} scroll-trigger animate--slide-in{% endif %}">
                            {% if variant_type > 1 %}
                              {%- if step_by_step_variant -%}<a role="link" aria-disabled="true" data-action="next" class="btn-next__variant product-form__submit button button--primary an-horizontal-shaking button-text-change">{{ 'products.product.step_by_step.next' | t }}</a>{%- endif -%}
                            {% endif %}
                            <div class="product-form__buttons">
                                {%- if current_variant.available -%}
                                    {%- if current_variant.inventory_management -%}
                                        {%- assign first_inventory = current_variant.inventory_quantity -%}
                                        {%- liquid
                                           if current_variant.available and first_inventory == 0
                                             assign allowOutStockSale = true 
                                           else
                                             assign allowOutStockSale = false
                                           endif
                                        -%}
                                        <button{% if variant_type > 1 %} data-action="cart"{% endif %} type="submit" name="add" data-btn-addToCart data-inventory-quantity="{{ current_variant.inventory_quantity }}" data-available="{{ allowOutStockSale }}" class="product-form__submit button button--primary an-{{ atc_animation }}{% if first_inventory == 0 %} button-text-change{% endif %}{% if settings.animations_hover_elements == '3d-lift' or settings.animations_hover_elements == 'vertical-lift' %} button-not-animation{% endif %}" id="product-add-to-cart">
                                            {%- if first_inventory > 0 -%}
                                                {{ 'products.product.add_to_cart' | t}}
                                            {%- else -%}
                                                {{ 'products.product.pre_order' | t }}
                                            {%- endif -%}
                                        </button>
                                    {%- else -%}
                                        <button{% if variant_type > 1 %} data-action="cart"{% endif %} type="submit" name="add" data-btn-addToCart class="product-form__submit button button--secondary an-{{ atc_animation }}{% if settings.animations_hover_elements == '3d-lift' or settings.animations_hover_elements == 'vertical-lift' %} button-not-animation{% endif %}" id="product-add-to-cart">
                                            {{ 'products.product.add_to_cart' | t}}
                                        </button>
                                    {%- endif -%}
                                {%- else -%}
                                    <button{% if variant_type > 1 %} data-action="cart"{% endif %} type="submit" name="add" data-btn-addToCart class="product-form__submit button{% if settings.animations_hover_elements == '3d-lift' or settings.animations_hover_elements == 'vertical-lift' %} button-not-animation{% endif %}" id="product-add-to-cart" disabled>{{ 'products.product.sold_out' | t }}</button>
                                {%- endif -%}
                            </div>
                        </div>

                        {%- comment -%} BUY NOW BUTTON - 50% WIDTH {%- endcomment -%}
                        {%- if show_dynamic_checkout -%}
                            <div class="productView-payment{% if settings.banner_animation == 'effect_fade_up' %} scroll-trigger animate--slide-in{% endif %}">
                                {{ form | payment_button }}
                            </div>
                        {%- endif -%}
                    </div>
                </div>
            </div>
        </div>
    {%- endform -%}
</product-form>



<style>
/* Force single line text only */
#product-add-to-cart {
    white-space: nowrap !important;
    overflow: hidden !important;
}

/* Remove any pseudo-elements that might duplicate text */
#product-add-to-cart::before,
#product-add-to-cart::after {
    display: none !important;
}

/* Hide step-by-step variant next button */
.btn-next__variant,
.btn-prev__variant {
    display: none !important;
}

/* WRAPPER GAP BETWEEN ADD TO CART + BUY NOW */
.productView-buttons {
    display: flex;
    gap: 10px !important;
}

/* Ensure both buttons take 50% width */
.productView-action,
.productView-payment {
    width: 50% !important;
}

/* ADD TO CART BUTTON */
#product-add-to-cart {
    background: #0CBFE2 !important;
    border-radius: 24px !important;
    border: none !important;
    color: #fff !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    height: 48px !important;
}

/* BUY NOW BUTTON (Shopify payment) */
.shopify-payment-button__button {
    border-radius: 24px !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    height: 48px !important;
}

/* Unbranded fallback */
.shopify-payment-button__button--unbranded {
    background: #0CBFE2 !important;
    color: #fff !important;
    border-radius: 24px !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    border: none !important;
}

/* Fix container corners */
.shopify-payment-button {
    border-radius: 24px !important;
    overflow: hidden !important;
}

/* QUANTITY SELECTOR STYLING */
.quantity__input,
.quantity input[type="number"],
input[name="quantity"] {
    border: 2px solid #0CBFE2 !important;
    border-radius: 12px !important;
    color: #0CBFE2 !important;
    font-weight: 600 !important;
}

/* Quantity +/- buttons */
.quantity__button,
.quantity button {
    border: 2px solid #0CBFE2 !important;
    border-radius: 12px !important;
    color: #0CBFE2 !important;
    background: #fff !important;
}

.quantity__button:hover,
.quantity button:hover {
    background: #0CBFE2 !important;
    color: #fff !important;
}

/* VARIANT/STYLE SELECTOR DROPDOWN */
.productView-groupTop select,
select[name="id"],
.product-form__input select {
    border: 2px solid #0CBFE2 !important;
    border-radius: 12px !important;
    color: #0CBFE2 !important;
    font-weight: 600 !important;
    padding: 12px 16px !important;
}

/* Variant option buttons (if using button-style variants) */
.product-form__input input[type="radio"] + label,
.variant-input-wrapper label {
    border: 2px solid #0CBFE2 !important;
    border-radius: 12px !important;
    color: #0CBFE2 !important;
}

.product-form__input input[type="radio"]:checked + label {
    background: #0CBFE2 !important;
    color: #fff !important;
}

/* ------------------ MOBILE OPTIMIZATION ------------------ */
@media (max-width: 480px) {

    /* Wrap container fixes */
    .productView-buttons {
        gap: 8px !important;
    }

    /* Equal 50% width on mobile too */
    .productView-action,
    .productView-payment {
        width: 50% !important;
    }

    /* ADD TO CART button smaller */
    #product-add-to-cart {
        height: 42px !important;
        font-size: 14px !important;
        border-radius: 18px !important;
        padding: 0 6px !important;
        white-space: nowrap !important;
    }

    /* BUY NOW button smaller */
    .shopify-payment-button__button,
    .shopify-payment-button__button--unbranded {
        height: 42px !important;
        font-size: 14px !important;
        border-radius: 18px !important;
        padding: 0 6px !important;
        white-space: nowrap !important;
    }

    /* Container fix for Shopify payment button */
    .shopify-payment-button {
        border-radius: 18px !important;
    }

    /* Fix for text overflow on very small screens */
    .productView-buttons button,
    .shopify-payment-button__button {
        text-overflow: ellipsis !important;
        overflow: hidden !important;
    }

    /* Quantity smaller */
    .quantity__input,
    .quantity input[type="number"],
    input[name="quantity"] {
        height: 38px !important;
        font-size: 14px !important;
        border-radius: 10px !important;
        padding: 0 8px !important;
    }

    /* Qty buttons smaller */
    .quantity__button,
    .quantity button {
        height: 38px !important;
        width: 38px !important;
        font-size: 14px !important;
        border-radius: 10px !important;
    }

    /* Variant dropdown smaller */
    .productView-groupTop select,
    select[name="id"],
    .product-form__input select {
        height: 42px !important;
        padding: 8px 10px !important;
        font-size: 14px !important;
        border-radius: 10px !important;
    }

    /* Variant buttons smaller */
    .product-form__input input[type="radio"] + label,
    .variant-input-wrapper label {
        padding: 8px 12px !important;
        font-size: 14px !important;
        border-radius: 10px !important;
    }
}




</style>